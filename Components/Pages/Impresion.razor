@layout Vacio
@inject NavigationManager NavigationManager
@inject IJSRuntime JS
@inject IRangoData RangoData
@inject IMaestraData MaestaData
@page "/Impresion/{idLinea:int}/{idProducto:int}/{idSeccion:int}/{idClasiVar:int}"



<RadzenDataGrid Data="@listaRango" TItem="Rango" AllowVirtualization="true" Style="height:400px" AllowFiltering="true"
    FilterPopupRenderMode="PopupRenderMode.OnDemand" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
    LogicalFilterOperator="LogicalFilterOperator.Or" AllowSorting="true">

    <Columns>
        <RadzenDataGridColumn Width="3%" TItem="Rango" Title="#" Filterable="false" Sortable="false"
            TextAlign="TextAlign.Center">
            <Template Context="data">
                <RadzenText class="mb-0 tipografia">@(listaRango.IndexOf(data) + 1)</RadzenText>
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="Rango" Filterable="false" Sortable="false" TextAlign="TextAlign.Center"
            Property="IdVariableNavigation.IdSeccionNavigation.Snombre" Title="SecciÃ³n" />
        <RadzenDataGridColumn TItem="Rango" Filterable="false" Sortable="false" TextAlign="TextAlign.Center"
            Property="IdVariableNavigation.Vnombre" Title="Variable" />
        <RadzenDataGridColumn TItem="Rango" Filterable="false" Sortable="false" TextAlign="TextAlign.Center"
            Property="IdVariableNavigation.IdUnidadNavigation.Unombre" Title="Unidad" />
        <RadzenDataGridColumn TItem="Rango" Title="2do Turno" Filterable="false" Sortable="false"
            TextAlign="TextAlign.Center">
            <Template Context="data">
                <input type="text" style="width: 50%; height:30px" disabled=true>
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="Rango" Title="1er Turno" Filterable="false" Sortable="false"
            TextAlign="TextAlign.Center">
            <Template Context="data">
                <input type="text" style="width: 50%; height:30px" disabled=true>
            </Template>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>



@code{
    public List<Rango> listaRango {get; set;} = new List<Rango>();
    public FiltrosRangoControlDTO filtros {get; set;}
    [Parameter]
    public int idLinea {get; set;} = 0;
    [Parameter]
    public int idProducto {get; set;} = 0;
    [Parameter]
    public int idSeccion {get; set;} = 0;
    [Parameter]
    public int idClasiVar {get; set;} = 0;
    public bool band  {get; set;} =  false;
    protected override async Task OnInitializedAsync()
    {
        band = false;
        filtros = new FiltrosRangoControlDTO();
        filtros.master = await MaestaData.GetMaestraPorLinea(idLinea);
        filtros.producto = idProducto;
        filtros.seccion = idSeccion;
        filtros.tipo = idClasiVar;
        listaRango = new List<Rango>();
        listaRango = await RangoData.GetRangoDeControl(filtros);
    }

    protected override void OnParametersSet()
    {   
        var a = NavigationManager.BaseUri;
        if(listaRango.Count != 0){
            JS.InvokeVoidAsync("imprimirElemento",NavigationManager.BaseUri);
        }
    }
}